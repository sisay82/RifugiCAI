<form style="position:relative" [formGroup]="servForm">
    <div [hidden]="!displayError" class="alert alert-danger">Error Occurred!</div>
    <div formArrayName="categories">
        <div *ngFor="let category of servForm.controls.categories.controls;let t = index">
            <div [formGroupName]="t">
                <div class="bc-h6 bc-service-title" style="white-space:nowrap;flex:1">{{category.controls.name.value}}</div>
                <div formArrayName="services">
                    <div *ngFor="let service of category.controls.services.controls;let i = index">
                        <div [formGroupName]="i">
                            <div style="display: flex;flex-direction:row;align-items:center">
                                <div class="bc-revision-services">
                                    <div class="bc-h6" style="white-space:nowrap;flex:1">Nome</div>
                                    <input type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                                        required class="form-control"  formControlName="name">
                                </div>
                                <div class="bc-revision-services">
                                    <div class="bc-h6" style="white-space:nowrap;flex:1">Categoria</div>
                                    <input type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                                        class="form-control"  formControlName="category">
                                </div>
                                <bc-icon (click)="removeService(t,i)" class="bc-add-tag" name="times" size=s></bc-icon>
                            </div>
                            <!--
                            <div class="bc-revision-services" style="width:64%">
                                <div class="bc-h6" style="white-space:nowrap;flex:1">Descrizione</div>
                                <input type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                                    class="form-control"  formControlName="description">
                            </div>
                            -->
                            <div formArrayName="tags">
                                <div *ngFor="let tag of service.controls.tags.controls;let j = index">
                                    <div style="position:relative;height:inherit" [formGroupName]="j">
                                        <div style="display: flex;flex-direction:row;height:inherit;align-items:center">
                                            <div class="bc-revision-services-tags">
                                                <div class="bc-body">Chiave</div>
                                                <input style="position:relative;height:inherit" type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                                                    class="form-control"  formControlName="key">
                                            </div>
                                            <div class="bc-revision-services-tags">
                                                <div class="bc-body">Valore</div>
                                                <input style="position:relative;height:inherit" type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                                                    class="form-control"  formControlName="value">
                                            </div>
                                            <bc-icon (click)="removeTag(t,i,j)" class="bc-add-tag" name="times" size=s></bc-icon>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div (click)="toggleTag(t,i)" class="bc-body bc-revision-services-tags bc-add-tag" style="white-space:nowrap;flex:1">Aggiungi Attributo</div>
                            <div *ngIf="!isHiddenTag(t,i)" style="display: flex;flex-direction:row;height:inherit;align-items:center">
                                <div class="bc-revision-services-tags">
                                    <div class="bc-body">Nuova Chiave</div>
                                    <input style="position:relative;height:inherit" type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                                        class="form-control"  formControlName="newTagKey">
                                </div>
                                <div class="bc-revision-services-tags">
                                    <div class="bc-body">Nuovo Valore</div>
                                    <input style="position:relative;height:inherit" type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                                        class="form-control"  formControlName="newTagValue">
                                </div>
                                <bc-icon (click)="addNewTag(t,i)" class="bc-add-tag" name="plus" size=s></bc-icon>
                            </div>
                        </div>
                        <br>
                        <bc-divider></bc-divider>
                    </div>
                </div>
                <br>
                <div (click)="toggleService(t)" class="bc-body bc-revision-services bc-add-tag" style="white-space:nowrap;flex:1">Aggiungi Servizio</div>
                <div *ngIf="!isHiddenService(t)" style="display: flex;flex-direction:row;height:inherit;align-items:center">
                    <div class="bc-revision-services">
                        <div class="bc-body">Nome</div>
                        <input style="position:relative;height:inherit" type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                            class="form-control"  formControlName="newServiceName">
                    </div>
                    <!--
                    <div class="bc-revision-services">
                        <div class="bc-body">Descrizione</div>
                        <input style="position:relative;height:inherit" type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                            class="form-control"  formControlName="newServiceDescription">
                    </div>
                    -->
                    <bc-icon (click)="addNewService(t)" class="bc-add-tag" name="plus" size=s></bc-icon>
                </div>
            </div>
            <br>
        </div>
    </div>
    <div (click)="toggleCategory()" class="bc-body bc-add-tag" style="white-space:nowrap;flex:1">Aggiungi Categoria</div>
    <div *ngIf="!isHiddenCategory()" style="display: flex;flex-direction:row;height:inherit;align-items:center">
        <div>
            <div class="bc-body">Categoria</div>
            <input style="position:relative;height:inherit" type="text" style="text-overflow: ellipsis; font-family: FontAwesome; font-style: normal; font-weight: normal; text-decoration: inherit;"
                class="form-control"  formControlName="newCategory">
        </div>
        <bc-icon (click)="addNewCategory()" class="bc-add-tag" name="plus" size=s></bc-icon>
    </div>

</form>